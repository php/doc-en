<?xml version="1.0" encoding="utf-8"?>
<!-- $Revision$ -->
<!-- Based on UPGRADING version 322438. Work in progress !-->

<appendix xml:id="migration54" xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">
 <title>Migrating from PHP 5.3.x to PHP 5.4.x</title>
 <simpara>
  &manual.migration.seealso;
  <link linkend="migration5">5.0.x</link>,
  <link linkend="migration51">5.1.x</link>,
  <link linkend="migration52">5.2.x</link>,
  <link linkend="migration53">5.3.x</link>,
  <link linkend="migration55">5.5.x</link> and
  <link linkend="migration56">5.6.x</link>.
 </simpara>

 <section xml:id="migration54.changes">
  <title>What has changed in PHP 5.4.x</title>
  <simpara>
   Most improvements in PHP 5.4.x have no impact on existing code.  There are
   a <link linkend="migration54.incompatible">few incompatibilities</link>
   and <link linkend="migration54.new-features">new features</link> that should
   be considered, and code should be tested before switching PHP
   versions in production environments.
  </simpara>
  <simpara>
   For systems being upgraded from an older version of PHP, the relevant
   documentation is available at:
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <link linkend="migration53">Upgrade Notes for PHP 5.3.x</link>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="migration52">Upgrade Notes for PHP 5.2.x</link>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="migration51">Upgrade Notes for PHP 5.1.x</link>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="migration5">Migrating from PHP 4 to PHP 5</link>.
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration54.incompatible">
  <title>Backward Incompatible Changes</title>
  <simpara>
   Although most existing PHP 5 code should work without changes, please take
   note of some backward incompatible changes:
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <link linkend="features.safe-mode">Safe mode</link> is no
     longer supported. Any applications that rely on safe mode may need
     adjustment, in terms of security.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="security.magicquotes">Magic quotes</link> has been removed. Applications relying
     on this feature may need to be updated, to avoid security issues.
    </simpara>
    <simpara>
     <function>get_magic_quotes_gpc</function> and <function>get_magic_quotes_runtime</function>
     now always return &false;. <function>set_magic_quotes_runtime</function> raises an
     <constant>E_CORE_ERROR</constant> level error on trying to enable <link linkend="security.magicquotes">Magic quotes</link>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     The <link linkend="ini.register-globals">register_globals</link> and
     <link linkend="ini.register-long-arrays">register_long_arrays</link> &php.ini; directives
     have been removed.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     The mbstring.script_encoding directive has been removed. Use <link linkend="ini.zend.script-encoding">zend.script_encoding</link> instead.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="language.references.pass">Call-time pass by reference</link> has been removed.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     The <link linkend="control-structures.break">break</link>
     and <link linkend="control-structures.continue">continue</link>
     statements no longer accept variable arguments (e.g., <literal>break 1 + foo() * $bar;</literal>).
     Static arguments still work, such as <literal>break 2;</literal>. As a side effect of this change
     <literal>break 0;</literal> and <literal>continue 0;</literal> are no longer allowed.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     The default character set for <function>htmlspecialchars</function>,
     <function>htmlentities</function> and <function>html_entity_decode</function> is now <literal>UTF-8</literal>,
     instead of <literal>ISO-8859-1</literal>.  Note that changing your output
     charset via the <link linkend="ini.default-charset">default_charset</link>
     configuration setting does not affect htmlspecialchars/htmlentities unless
     you are passing "" (an empty string) as the encoding parameter to your 
     <function>htmlspecialchars</function>/<function>htmlentities</function>/<function>html_entity_decode</function> calls.
     Generally we do not recommend doing this because you should be able to
     change your output charset without affecting the runtime charset used by
     these functions. The safest approach is to explicitly set the charset on
     each call to <function>htmlspecialchars</function>,
     <function>htmlentities</function> and <function>html_entity_decode</function>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     In the <link linkend="book.datetime">date and time extension</link>, the timezone can no longer be
     set using the TZ environment variable. Instead you have to specify a timezone using the
     <link linkend="ini.date.timezone">date.timezone</link> &php.ini; option or <function>date_default_timezone_set</function>
     function. PHP will no longer attempt to guess the timezone, and will instead fall back to "UTC" and issue
     a <constant>E_WARNING</constant>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Non-numeric string offsets - e.g. <literal>$a['foo']</literal> where $a is a string - now return
     false on <function>isset</function> and true on <function>empty</function>, and produce a <constant>E_WARNING</constant>
     if you try to use them. Offsets of types double, bool and null produce a <constant>E_NOTICE</constant>. Numeric strings
     (e.g. <literal>$a['2']</literal>) still work as before. Note that offsets like <literal>'12.3'</literal>
     and <literal>'5 foobar'</literal> are considered non-numeric and produce a <constant>E_WARNING</constant>, but are converted
     to 12 and 5 respectively, for backward compatibility reasons.
    </simpara>
    <simpara>
     Note: Following code returns different result.
    </simpara>
    <simpara>
     $str='abc';var_dump(isset($str['x'])); // false for PHP 5.4 or later, but true for 5.3 or less
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Converting an array to a string will now generate an <constant>E_NOTICE</constant> level
     error, but the result of the cast will still be the string <literal>"Array"</literal>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Turning &null;, &false;, or an empty string into an object by adding a property
     will now emit an <constant>E_WARNING</constant> level error, instead of <constant>E_STRICT</constant>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Parameter names that shadow super globals now cause a fatal error. This prohibits code like
     <literal>function foo($_GET, $_POST) {}</literal>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     The Salsa10 and Salsa20 <link linkend="book.hash">hash algorithms</link> have been removed.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     The Tiger <link linkend="book.hash">hash algorithm</link> now uses big-endian byte ordering.
     Please follow <link linkend="function.hash.tiger-bc">this example</link> to write code that
     is compatible with both PHP 5.3 and 5.4.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>array_combine</function> now returns <literal>array()</literal> instead of &false;
     when two empty arrays are provided as parameters.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     If you use <function>htmlentities</function> with asian character sets, it
     works like <function>htmlspecialchars</function> - this has always been the
     case in previous versions of PHP, but now an <constant>E_STRICT</constant>
     level error is emitted.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     The third parameter of <function>ob_start</function> has changed from
     <type>boolean</type> <parameter>erase</parameter> to <type>integer</type>
     <parameter>flags</parameter>. Note that code that explicitly set
     <parameter>erase</parameter> to &false; will no longer behave as expected
     in PHP 5.4: please follow
     <link linkend="function.ob-start.flags-bc">this example</link> to write
     code that is compatible with PHP 5.3 and 5.4.
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara>
   The following keywords are now <link linkend="reserved">reserved</link>, and may not be used
   as names by functions, classes, etc.
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <link linkend="language.oop5.traits">trait</link>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="language.types.callable">callable</link>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="language.oop5.traits">insteadof</link>
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara>
   The following functions have been removed from PHP:
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>define_syslog_variables</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>import_request_variables</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>session_is_registered</function>, <function>session_register</function>
     and <function>session_unregister</function>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     The aliases
     <function>mysqli_bind_param</function>, <function>mysqli_bind_result</function>,
     <function>mysqli_client_encoding</function>, <function>mysqli_fetch</function>,
     <function>mysqli_param_count</function>, <function>mysqli_get_metadata</function>,
     <function>mysqli_send_long_data</function>, mysqli::client_encoding() and mysqli_stmt::stmt().
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration54.new-features">
  <title>New features</title>
  <simpara>
   PHP 5.4.0 offers a wide range of new features:
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     Support for <link linkend="language.oop5.traits">traits</link> has been added.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Short array syntax has been added, e.g. <literal>$a = [1, 2, 3, 4];</literal> or
     <literal>$a = ['one' => 1, 'two' => 2, 'three' => 3, 'four' => 4];</literal>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Function array dereferencing has been added, e.g. <literal>foo()[0]</literal>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="functions.anonymous">Closures</link> now support <literal>$this</literal>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <literal>&lt;?=</literal> is now always available, regardless of the
     <link linkend="ini.short-open-tag">short_open_tag</link> &php.ini; option.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Class member access on instantiation has been added,
     e.g. <literal>(new Foo)-&gt;bar()</literal>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <literal>Class::{expr}()</literal> syntax is now supported.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Binary number format has been added, e.g. <literal>0b001001101</literal>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Improved parse error messages and improved incompatible arguments warnings.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     The session extension can now track the <link linkend="session.upload-progress">upload progress</link> of files.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Built-in development <link linkend="features.commandline.webserver">web server in CLI mode</link>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     The GD extension now supports reading and writing of WebP images via
     <function>imagecreatefromwebp</function> and <function>imagewebp</function>,
     respectively.
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration54.sapi">
  <title>Changes in SAPI modules</title>
  <itemizedlist>
   <listitem>
    <simpara>
     A new SAPI module named <literal>cli-server</literal> is now available.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Added CLI option <literal>--rz</literal> which shows information of the named Zend extension.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Added shortcut <literal>#inisetting=value</literal> to change &php.ini; settings at run-time in interactive readline CLI
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Added apache compatible functions: <function>apache_child_terminate</function>,
     <function>getallheaders</function>, <function>apache_request_headers</function>
     and <function>apache_response_headers</function> for FastCGI SAPI.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     PHP-FPM: Added the <literal>process.max</literal> setting, to control the number
     of processes that FPM can fork.
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration54.deprecated">
  <title>Deprecated features in PHP 5.4.x</title>
  <simpara>
   Deprecated functions:
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>mysql_list_dbs</function>
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration54.parameters">
  <title>Changed Functions</title>
  <simpara>
   Several functions were given new, optional parameters in PHP 5.4:
  </simpara>
  <simpara>PHP Core:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     Added the optional <parameter>limit</parameter> parameter to <function>debug_backtrace</function>
     and <function>debug_print_backtrace</function>, to limit the amount of stack frames returned.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>is_link</function> now works properly for symbolic links on Windows Vista
     or later. Earlier systems do not support symbolic links.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>parse_url</function> now recognizes the host when a scheme is omitted, 
     and a leading component separator is present. As of PHP 5.4.7.
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara>OpenSSL:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     Added a no padding option to the <function>openssl_encrypt</function> and <function>openssl_decrypt</function>
     functions.
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara>Intl:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>idn_to_ascii</function> and <function>idn_to_utf8</function> now take two extra
     parameters, one indicating the variant (IDNA 2003 or UTS #46) and another, passed by reference,
     to return details about the operation in case UTS #46 is chosen.
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration54.functions">
  <title>New Functions</title>
  <simpara>
   PHP 5.4 introduced some new functions:
  </simpara>
  <simpara>PHP Core:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>hex2bin</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>http_response_code</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>get_declared_traits</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>getimagesizefromstring</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>stream_set_chunk_size</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>socket_import_stream</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>trait_exists</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>header_register_callback</function>
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara><link linkend="book.spl">SPL:</link></simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>class_uses</function>
    </simpara>
   </listitem>
   </itemizedlist>
   <simpara><link linkend="book.session">Session:</link></simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>session_status</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>session_register_shutdown</function>
    </simpara>
   </listitem>
   </itemizedlist>
   <simpara><link linkend="book.mysqli">Mysqli:</link></simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>mysqli_error_list</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>mysqli_stmt_error_list</function>
    </simpara>
   </listitem>
   </itemizedlist>
   <simpara><link linkend="book.libxml">Libxml:</link></simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>libxml_set_external_entity_loader</function>
    </simpara>
   </listitem>
   </itemizedlist>
   <simpara><link linkend="book.ldap">LDAP:</link></simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>ldap_control_paged_result</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>ldap_control_paged_result_response</function>
    </simpara>
   </listitem>
   </itemizedlist>
   <simpara><link linkend="book.intl">Intl:</link></simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>transliterator_create</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>transliterator_create_from_rules</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>transliterator_create_inverse</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>transliterator_get_error_code</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>transliterator_get_error_message</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>transliterator_list_ids</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>transliterator_transliterate</function>
    </simpara>
   </listitem>
  </itemizedlist>
   <simpara><link linkend="book.zlib">Zlib:</link></simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>zlib_decode</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>zlib_encode</function>
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration54.classes">
  <title>New Classes and Interfaces</title>
  <simpara>
   The following classes were introduced in PHP 5.4.0:
  </simpara>
  <simpara><link linkend="book.spl">SPL</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <classname>CallbackFilterIterator</classname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <classname>RecursiveCallbackFilterIterator</classname>
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara><link linkend="book.reflection">Reflection</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <classname>ReflectionZendExtension</classname>
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara><link linkend="book.json">Json</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <classname>JsonSerializable</classname>
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara><link linkend="book.session">Session</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <classname>SessionHandler</classname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <classname>SessionHandlerInterface</classname>
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara><link linkend="book.snmp">Snmp</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <classname>SNMP</classname>
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara><link linkend="book.intl">Intl</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <classname>Transliterator</classname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <classname>Spoofchecker</classname>
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration54.methods">
  <title>New Methods</title>
  <simpara>
   Several new methods were introduced in 5.4.0:
  </simpara>
  <simpara><link linkend="book.xsl">XSL</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <methodname>XsltProcessor::setSecurityPrefs</methodname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <methodname>XsltProcessor::getSecurityPrefs</methodname>
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara><link linkend="book.spl">SPL</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <methodname>RegexIterator::getRegex</methodname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <methodname>SplObjectStorage::getHash</methodname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <methodname>DirectoryIterator::getExtension</methodname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <methodname>SplDoublyLinkedList::serialize</methodname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <methodname>SplDoublyLinkedList::unserialize</methodname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <methodname>SplFileInfo::getExtension</methodname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <methodname>SplFileObject::fputcsv</methodname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <methodname>SplQueue::serialize</methodname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <methodname>SplQueue::unserialize</methodname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <methodname>SplStack::serialize</methodname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <methodname>SplStack::unserialize</methodname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <methodname>SplTempFileObject::fputcsv</methodname>
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara><link linkend="book.reflection">Reflection</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <methodname>ReflectionExtension::isPersistent</methodname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <methodname>ReflectionExtension::isTemporary</methodname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <methodname>ReflectionClass::isCloneable</methodname>
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara><classname>Closure</classname>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <methodname>Closure::bind</methodname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <methodname>Closure::bindTo</methodname>
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara><link linkend="ref.pdo-dblib">PDO_dblib</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <methodname>PDO::newRowset</methodname>
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara><classname>StreamWrapper</classname>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <methodname>StreamWrapper::stream_metadata</methodname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <methodname>StreamWrapper::stream_truncate</methodname>
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration54.removed-extensions">
  <title>Removed Extensions</title>
  <simpara>
   These extensions have been moved to PECL and are no longer part of the PHP
   distribution. The PECL package versions of these extensions will be created
   according to user demand.
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <link linkend="book.sqlite">sqlite</link>
     - Note that ext/sqlite3 and ext/pdo_sqlite are not affected
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration54.extensions-other">
  <title>Other changes to extensions</title>
  <simpara>
   Changes in extension behavior, and new features:
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <link linkend="book.mysqli">mysqli</link>
     - <classname>mysqli_result</classname> now implements <link linkend="class.traversable">Traversable</link>
    </simpara>
   </listitem>
  </itemizedlist>
  <itemizedlist>
   <listitem>
    <simpara>
     <link linkend="ref.pdo-mysql">pdo_mysql</link>
     - Removed support for linking with MySQL client libraries older than 4.1
    </simpara>
   </listitem>
  </itemizedlist>
  <itemizedlist>
   <listitem>
  <simpara>
   The MySQL extensions <link linkend="book.mysql">mysql</link>,
   <link linkend="book.mysqli">mysqli</link> and <link linkend="ref.pdo-mysql">PDO_mysql</link>
   use <link linkend="book.mysqlnd">mysqlnd</link> as the default library now. It is still possible to use
   libmysqlclient by specifying a path to the configure options.
    </simpara>
  </listitem>
  </itemizedlist>
  <itemizedlist>
   <listitem>
    <simpara>
     <link linkend="book.mysqlnd">mysqlnd</link>
     - Added named pipes support
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration54.global-constants">
  <title>New Global Constants</title>

  <simpara>PHP Core:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <constant>ENT_DISALLOWED</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>ENT_HTML401</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>ENT_HTML5</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>ENT_SUBSTITUTE</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>ENT_XML1</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>ENT_XHTML</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IPPROTO_IP</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IPPROTO_IPV6</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IPV6_MULTICAST_HOPS</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IPV6_MULTICAST_IF</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IPV6_MULTICAST_LOOP</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IP_MULTICAST_IF</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IP_MULTICAST_LOOP</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IP_MULTICAST_TTL</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>MCAST_JOIN_GROUP</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>MCAST_LEAVE_GROUP</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>MCAST_BLOCK_SOURCE</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>MCAST_UNBLOCK_SOURCE</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>MCAST_JOIN_SOURCE_GROUP</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>MCAST_LEAVE_SOURCE_GROUP</constant>
    </simpara>
   </listitem>
  </itemizedlist>

   <simpara><link linkend="book.curl">Curl</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <constant>CURLOPT_MAX_RECV_SPEED_LARGE</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>CURLOPT_MAX_SEND_SPEED_LARGE</constant>
    </simpara>
   </listitem>
   </itemizedlist>

  <simpara><link linkend="book.libxml">LibXML</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <constant>LIBXML_HTML_NODEFDTD</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>LIBXML_HTML_NOIMPLIED</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>LIBXML_PEDANTIC</constant>
    </simpara>
   </listitem>
   </itemizedlist>

   <simpara><link linkend="book.openssl">OpenSSL</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <constant>OPENSSL_CIPHER_AES_128_CBC</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>OPENSSL_CIPHER_AES_192_CBC</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>OPENSSL_CIPHER_AES_256_CBC</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>OPENSSL_RAW_DATA</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>OPENSSL_ZERO_PADDING</constant>
    </simpara>
   </listitem>
   </itemizedlist>

  <simpara><link linkend="book.outcontrol">Output buffering</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <constant>PHP_OUTPUT_HANDLER_CLEAN</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_OUTPUT_HANDLER_CLEANABLE</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_OUTPUT_HANDLER_DISABLED</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_OUTPUT_HANDLER_FINAL</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_OUTPUT_HANDLER_FLUSH</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_OUTPUT_HANDLER_FLUSHABLE</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_OUTPUT_HANDLER_REMOVABLE</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_OUTPUT_HANDLER_STARTED</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_OUTPUT_HANDLER_STDFLAGS</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_OUTPUT_HANDLER_WRITE</constant>
    </simpara>
   </listitem>
   </itemizedlist>

   <simpara><link linkend="book.session">Sessions</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <constant>PHP_SESSION_ACTIVE</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_SESSION_DISABLED</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_SESSION_NONE</constant>
    </simpara>
   </listitem>
   </itemizedlist>

   <simpara><link linkend="book.stream">Streams</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <constant>STREAM_META_ACCESS</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>STREAM_META_GROUP</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>STREAM_META_GROUP_NAME</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>STREAM_META_OWNER</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>STREAM_META_OWNER_NAME</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>STREAM_META_TOUCH</constant>
    </simpara>
   </listitem>
   </itemizedlist>

   <simpara><link linkend="book.zlib">Zlib</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <constant>ZLIB_ENCODING_DEFLATE</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>ZLIB_ENCODING_GZIP</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>ZLIB_ENCODING_RAW</constant>
    </simpara>
   </listitem>
  </itemizedlist>

  <simpara><link linkend="book.intl">Intl</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <constant>U_IDNA_DOMAIN_NAME_TOO_LONG_ERROR</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_CHECK_BIDI</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_CHECK_CONTEXTJ</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_NONTRANSITIONAL_TO_ASCII</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_NONTRANSITIONAL_TO_UNICODE</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>INTL_IDNA_VARIANT_2003</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>INTL_IDNA_VARIANT_UTS46</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_ERROR_EMPTY_LABEL</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_ERROR_LABEL_TOO_LONG</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_ERROR_DOMAIN_NAME_TOO_LONG</constant>
    </simpara>
   </listitem>
   <listitem>
   <simpara>
     <constant>IDNA_ERROR_LEADING_HYPHEN</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_ERROR_TRAILING_HYPHEN</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_ERROR_HYPHEN_3_4</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_ERROR_LEADING_COMBINING_MARK</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_ERROR_DISALLOWED</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_ERROR_PUNYCODE</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_ERROR_LABEL_HAS_DOT</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_ERROR_INVALID_ACE_LABEL</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_ERROR_BIDI</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_ERROR_CONTEXTJ</constant>
    </simpara>
   </listitem>
  </itemizedlist>

  <simpara><link linkend="book.json">Json</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <constant>JSON_PRETTY_PRINT</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>JSON_UNESCAPED_SLASHES</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>JSON_NUMERIC_CHECK</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>JSON_UNESCAPED_UNICODE</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>JSON_BIGINT_AS_STRING</constant>
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration54.ini">
  <title>Changes to INI file handling</title>
  <simpara>
   The following &php.ini; directives have been removed:
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <link linkend="ini.register-globals">register_globals</link> and
     <link linkend="ini.register-long-arrays">register_long_arrays</link>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="ini.magic-quotes-gpc">magic_quotes_gpc</link>,
     <link linkend="ini.magic-quotes-runtime">magic_quotes_runtime</link>,
     and <link linkend="ini.magic-quotes-sybase">magic_quotes_sybase</link>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="ini.allow-call-time-pass-reference">allow_call_time_pass_reference</link>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="ini.define-syslog-variables">define_syslog_variables</link>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="ini.syntax-highlighting">highlight.bg</link>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="ini.session.bug-compat-42">session.bug_compat_42</link> and
     <link linkend="ini.session.bug-compat-warn">session.bug_compat_warn</link>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     mbstring.script_encoding
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="ini.y2k-compliance">y2k_compliance</link>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="ini.safe-mode">safe_mode</link>,
     <link linkend="ini.safe-mode-gid">safe_mode_gid</link>,
     <link linkend="ini.safe-mode-include-dir">safe_mode_include_dir</link>,
     <link linkend="ini.safe-mode-exec-dir">safe_mode_exec_dir</link>,
     <link linkend="ini.safe-mode-allowed-env-vars">safe_mode_allowed_env_vars</link>, and
     <link linkend="ini.safe-mode-protected-env-vars">safe_mode_protected_env_vars</link>
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara>
   The following &php.ini; directives have been added:
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <link linkend="ini.cli.pager">cli.pager</link> and
     <link linkend="ini.cli.prompt">cli.prompt</link> for CLI SAPI using readline
     in interactive mode.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="ini.cli-server.color">cli_server.color</link>
     to enable the built-in development web server to use ANSI color coding 
     in terminal output.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="ini.max-input-vars">max_input_vars</link>
     - specifies how many GET/POST/COOKIE input variables may be accepted.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="ini.zend.multibyte">zend.multibyte</link>
     - to control the new multibyte support.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="ini.zend.script-encoding">zend.script_encoding</link>
     - This value will be used unless a "declare(encoding=...)" directive
     appears at the top of the script.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="ini.zend.signal-check">zend.signal_check</link>
     - to check for replaced signal handlers on shutdown.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="ini.session.upload-progress.enabled">session.upload_progress.enabled</link>,
     <link linkend="ini.session.upload-progress.cleanup">session.upload_progress.cleanup</link>,
     <link linkend="ini.session.upload-progress.prefix">session.upload_progress.prefix</link>,
     <link linkend="ini.session.upload-progress.name">session.upload_progress.name</link>,
     <link linkend="ini.session.upload-progress.freq">session.upload_progress.freq</link>,
     <link linkend="ini.session.upload-progress.min-freq">session.upload_progress.min_freq</link>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="ini.enable-post-data-reading">enable_post_data_reading</link>
     - When it's disabled, the POST data is not read (and processed)
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="ini.windows-show-crt-warning">windows_show_crt_warning</link>
     - This directive shows the Windows CRT warnings when enabled. These
     warnings were displayed by default until now.
    </simpara>
   </listitem>
   </itemizedlist>
  <simpara>
   The following &php.ini; directives have been changed:
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <link linkend="ini.session.entropy-file">session.entropy_file</link>
     now defaults to /dev/random or /dev/urandom depending on what has been
     guessed at compile time.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="ini.session.entropy-length">session.entropy_length</link>
     now defaults to 32.
    </simpara>
   </listitem>
   </itemizedlist>
 </section>

 <section xml:id="migration54.other">
  <title>Other changes</title>
  <itemizedlist>
   <listitem>
    <simpara>
     <constant>E_ALL</constant> now includes <constant>E_STRICT</constant> level
     errors in the <link linkend="ini.error-reporting">error_reporting</link> configuration directive.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="book.snmp">SNMP</link> now has an OOP API.
    </simpara>
    <simpara>
      Functions now return &false; on every error condition including SNMP-related
      (no such instance, end of MIB, etc). Thus, in particular, breaks previous behavior
      of get/walk functions returning an empty string on SNMP-related errors.
    </simpara>
    <simpara>
      Multi OID get/getnext/set queries are now supported.
    </simpara>
    <simpara>
     Dropped UCD-SNMP compatibility code, consider upgrading to net-snmp v5.3+, Net-SNMP v5.4+ is
     required for Windows version.
    </simpara>
    <simpara>
     In sake of adding support for IPv6 DNS name resolution of
     remote SNMP agent (peer) is done by extension now, not by Net-SNMP library anymore.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="book.openssl">OpenSSL</link> now supports AES.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="features.commandline">CLI SAPI</link> doesn't terminate any
     more on fatal errors when using interactive mode with readline support.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="language.variables.superglobals">$_SERVER['REQUEST_TIME_FLOAT']</link>
     has been added to include microsecond precision.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Added new hash algorithms: fnv132, fnv164, joaat
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Chained string offsets - e.g. $a[0][0] where $a is a string - now work.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Arrays cast from <type>SimpleXMLElement</type> now <emphasis>always</emphasis> contain all nodes instead of
     just the first matching node. All <type>SimpleXMLElement</type> children are now <emphasis>always</emphasis>
     printed when using <function>var_dump</function>, <function>var_export</function> and
     <function>print_r</function>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     It's now possible to enforce the class' <link linkend="language.oop5.decon">__construct</link> arguments in an abstract
     constructor in the base class.
    </simpara>
   </listitem>
  </itemizedlist>
 </section>
</appendix>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"~/.phpdoc/manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
